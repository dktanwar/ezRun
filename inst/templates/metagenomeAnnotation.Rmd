---
title: "`r paste('Shotgun metagenomics analysis report')`"
author: "Functional Genomics Center Zurich"
output: 
  html_document:
    self_contained: false
    includes:
      in_header: fgcz_header.html
    css: fgcz.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=FALSE, message=FALSE, out.width = "49%")
## This report requires summary files form mothur
debug <- FALSE
setEnvironments("phantomjs")
```

```{r prepare data, include=FALSE}
##Prodigal
summaryScorePlotList <- summaryScorePlot(fullSummPlot)

summaryConfPlotList <-summaryConfPlot(subsetDataToPartial00Plot)

summaryGcContPlotList <- summaryGcContPlot(subsetDataToPartial00Plot)

summaryRBSSpacePlotList <- summaryRBSSpacePlot(subsetDataToPartial00Plot)
  
summaryRBSMotifPlotList <- summaryRBSMotifPlot(subsetDataToPartial00Plot)


## Inteproscan
### summary  plots : matching score 
summaryMatchScorePlot <-   summaryMatchScorePlot(interproscanListForWrap$summDF)
summaryFamilyPlot <- summaryFamilyPlot(interproscanListForWrap$topN_desc, numberOfTopNCategories)
summaryGOPlot <- summaryGOPlot(interproscanListForWrap$topN_GO, numberOfTopNCategories)
```


Started on `r format(Sys.time(), "%Y-%m-%d %H:%M:%S")`

## Data pre-processing {.tabset}

### Prodigal gene prediction:summary score
```{r summaryScorePlotMegahit, echo=FALSE,out.width="100%"}
plot(summaryScorePlotList)
```

### Prodigal gene prediction: confidence, GC_content and RBS 
```{r summaryConfPlotListMegahit, echo=FALSE}
plot(summaryConfPlotList)
plot(summaryGcContPlotList)
plot(summaryRBSSpacePlotList)
plot(summaryRBSMotifPlotList)
```

### Interproscan annotation:  proteins match scores and functional annotation
```{r summaryMatchScorePlot, echo=FALSE,out.width="80%", fig.height=4}
plot(summaryMatchScorePlot)
```

```{r summaryGOFam, echo=FALSE,out.width="100%", fig.height=4}
plot(summaryFamilyPlot)
plot(summaryGOPlot)
```
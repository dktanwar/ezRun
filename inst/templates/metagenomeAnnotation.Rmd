---
title: "`r paste('Shotgun metagenomics analysis report')`"
author: "Functional Genomics Center Zurich"
output: 
  html_document:
    self_contained: false
    includes:
      in_header: fgcz_header.html
    css: fgcz.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning=FALSE, message=FALSE, out.width = "49%")
## This report requires summary files form mothur
debug <- FALSE
setEnvironments("phantomjs")
```

```{r prepare data, include=FALSE}
##Prodigal
summaryScorePlotList <- lapply(prodigalList, function(x)summaryScorePlot(x$fullSumm))

summaryConfPlotList <- lapply(prodigalList, function(x)summaryConfPlot(x$subsetDataToPartial00))

summaryGcContPlotList <- lapply(prodigalList, function(x)summaryGcContPlot(x$subsetDataToPartial00))

summaryRBSSpacePlotList <- lapply(prodigalList, function(x)summaryRBSSpacePlot(x$subsetDataToPartial00))
  
summaryRBSMotifPlotList <- lapply(prodigalList, function(x)summaryRBSMotifPlot(x$subsetDataToPartial00))


## Inteproscan
### summary  plots : matching score 
summaryMatchScorePlot <-   summaryMatchScorePlot(interproscanListForWrap$summDF)
summaryFamilyPlot <- summaryFamilyPlot(interproscanListForWrap$topN_desc, numberOfTopNCategories)
summaryGOPlot <- summaryGOPlot(interproscanListForWrap$topN_GO, numberOfTopNCategories)
```


Started on `r format(Sys.time(), "%Y-%m-%d %H:%M:%S")`

## Data pre-processing {.tabset}

### Prodigal gene prediction:Summary score plot
```{r summaryScorePlotMegahit, echo=FALSE, fig.cap="Megahit"}
plot(summaryScorePlotList[["megahit"]])
```

```{r summaryScorePlotMetaspades, echo=FALSE, fig.cap="Metaspades"}
plot(summaryScorePlotList[["metaspades"]])
```

```{r summaryConfPlotListMegahit, echo=FALSE, fig.cap="Megahit"}
plot(summaryConfPlotList[["megahit"]])
```

```{r summaryConfPlotListMetaspades, echo=FALSE, fig.cap="Metaspades"}
plot(summaryConfPlotList[["metaspades"]])
```

```{r summaryGcContPlotListtMegahit, echo=FALSE, fig.cap="Megahit"}
plot(summaryConfPlotList[["megahit"]])
```

```{r summaryGcContPlotListMetaspades, echo=FALSE, fig.cap="Metaspades"}
plot(summaryGcContPlotList[["metaspades"]])
```

### Prodigal gene prediction:Summary spacer plot
```{r summaryRBSSpacePlotListMegahit, echo=FALSE, fig.cap="Megahit"}
plot(summaryRBSSpacePlotList[["megahit"]])
```

```{r summaryRBSSpacePlotListMetaspades, echo=FALSE, fig.cap="Metaspades"}
plot(summaryRBSSpacePlotList[["metaspades"]])
```

### Prodigal gene prediction:Summary motif plot
```{r summaryRBSMotifPlotListMH, echo=FALSE, fig.cap="Megahit"}
plot(summaryRBSMotifPlotList[["megahit"]])
```

```{r summaryRBSMotifPlotListMS, echo=FALSE, fig.cap="Metaspades"}
plot(summaryRBSMotifPlotList[["metaspades"]])
```

### Interproscan annotation
#### Summary of matched proteins score
```{r summaryMatchScorePlot, echo=FALSE,out.width="70%"}
plot(summaryFamilyPlot)
```

#### Summary of functional annotation
```{r summaryMatchScorePlot, echo=FALSE,out.width="70%"}
plot(summaryGOPlot)
plot(summaryMatchScorePlot)
```
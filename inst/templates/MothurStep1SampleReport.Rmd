---
title: "`r paste('Mothur data analysis report: preprocessing')`"
author: "Functional Genomics Center Zurich"
output: 
  html_document:
    self_contained: false
    includes:
      in_header: fgcz_header.html
    css: fgcz.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
## This report requires output files form the DataAnalysis App

debug <- FALSE
setEnvironments("phantomjs")
```

```{r prepare data, include=FALSE}
### raw data summary tables
summaryTablesToReport <- grep("Summary",names(listOfListAllFiles), value = T)
summaryTablesToReport <- grep("stepConvergence", summaryTablesToReport, invert = T, value = T)
summaryTablesToReport <- listOfListAllFiles[summaryTablesToReport]

finalListOfSummaryTables <- imap(summaryTablesToReport,function(x,y)
  createSummaryTableForKableExtra(x))
```

Started on `r format(Sys.time(), "%Y-%m-%d %H:%M:%S")`

## Data pre-processing {.tabset}

### Summary of the raw reads
```{r RawDataSummary, echo=FALSE}
RDSplot <- plotFromMothurSumm(finalListOfSummaryTables["RawDataSummary"])
plot(RDSplot)
```

### Summary of the deduplicated reads
```{r DeduppedSummary, echo=FALSE}
DDplot <- plotFromMothurSumm(finalListOfSummaryTables["DeduppedSummary"])
plot(DDplot)
```

### Summary of the reads filtered by length and homopolymers
```{r LenAndHomopSummary, echo=FALSE}
LHplot <- plotFromMothurSumm(finalListOfSummaryTables["LenAndHomopSummary"])
plot(LHplot)
```
